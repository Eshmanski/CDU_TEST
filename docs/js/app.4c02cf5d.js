(function(){"use strict";var e={3399:function(e,t,s){var n=s(9242),o=s(3396);function r(e,t,s,n,r,i){const a=(0,o.up)("MapBox");return(0,o.wg)(),(0,o.j4)(a)}var i=s(2482),a=s(6520);const c={class:"map__box"};function l(e,t,s,n,r,i){const a=(0,o.up)("map-progress"),l=(0,o.up)("Map"),d=(0,o.up)("map-controller");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(a),(0,o.Wm)(l,{isPlay:e.isPlay,chosenSpeed:e.chosenSpeed},null,8,["isPlay","chosenSpeed"]),(0,o.Wm)(d,{isPlay:e.isPlay,speeds:e.speeds,speedIndex:e.speedIndex,onStartPlay:t[0]||(t[0]=t=>e.isPlay=!0),onStopPlay:t[1]||(t[1]=t=>e.isPlay=!1),onSetSpeedIndex:t[2]||(t[2]=t=>e.speedIndex=t)},null,8,["isPlay","speeds","speedIndex"])])}const d=e=>((0,o.dD)("data-v-24e1cd46"),e=e(),(0,o.Cn)(),e),p={class:"map__wrapper"},u=d((()=>(0,o._)("div",{id:"map__box",class:"map"},null,-1))),h=[u];function f(e,t,s,n,r,i){return(0,o.wg)(),(0,o.iD)("div",p,h)}function m(e,t){const s=6371,n=Math.sin((e[1]-t[1])*Math.PI/180/2),o=Math.sin((e[0]-t[0])*Math.PI/180/2);return 2*s*Math.asin(Math.sqrt(n*n+o*o*Math.cos(e[1]*Math.PI/180)*Math.cos(t[1]*Math.PI/180)))}function g(){let e=null;return(t,s)=>{let n=!1;if(null===e||null===t)n=!1;else{const o=m([e.lon,e.lat],[t.lon,t.lat]),r=m([t.lon,t.lat],[s.lon,s.lat]),i=m([e.lon,e.lat],[s.lon,s.lat]);0===o&&(n=!0),o>i&&r>i&&(n=!0)}return e=t,n}}const v=g();var y=s(7709),_=s.n(y),b={accessTokenMapBox:"pk.eyJ1Ijoia3VyYWoiLCJhIjoiY2wydGdwNjE3MDNiNzNjbzl1cnc2cGFsOSJ9.AUYn7rQFnRkGm1lsMjeqfw"};class w{constructor(e){(0,i.Z)(this,"map",void 0),(0,i.Z)(this,"marker",void 0),(0,i.Z)(this,"markerPosition",[0,0]),(0,i.Z)(this,"markerStyle","\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    border: 2px solid white;\n    background-color: rgb(0, 0, 241);\n  "),(0,i.Z)(this,"token",b.accessTokenMapBox),_().accessToken=this.token,this.map=new(_().Map)({container:e,style:"mapbox://styles/mapbox/streets-v11",center:[37.610225,55.651365],zoom:13});const t=document.createElement("div");t.style.cssText=this.markerStyle,this.marker=new(_().Marker)(t).setLngLat([0,0]).addTo(this.map)}onLoad(e){this.map.on("load",e)}resize(){this.map.resize()}createLine(e,t,s,n){this.map.addSource(e,{type:"geojson",data:w.getGeoJSON()}),this.map.addLayer({id:e,type:"line",source:e,paint:{"line-color":t,"line-opacity":s,"line-width":8}})}setCoordinatesToLine(e,t){this.map.getSource(e).setData(w.getGeoJSON(t))}setCoordinateToMarker(e){this.markerPosition=e,this.marker.setLngLat(e)}moveToPointWithPlume(e,t,s,n,o){let r=m(this.markerPosition,s);0===r&&(r=.001);const i=t.slice(0,t.length-2),a=r/n*36e5,c=s[0]-this.markerPosition[0],l=s[1]-this.markerPosition[1];let d,p=!0,u=0;const h=n=>{p&&(p=!1,u=n);const r=n-u,f=[this.markerPosition[0]+c*(r/a),this.markerPosition[1]+l*(r/a)];this.marker.setLngLat(f),this.setCoordinatesToLine(e,[...i,f]),this.map.panTo(f),a>r?d=requestAnimationFrame(h):(cancelAnimationFrame(d),this.setCoordinateToMarker(s),this.setCoordinatesToLine(e,t),this.map.panTo(s),o(d))};return requestAnimationFrame(h)}static getGeoJSON(e=[]){return{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}}}var P=w,x=s(65),k=function(e,t,s,n){var o,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,s,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,s,i):o(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};let C=class extends a.w3{constructor(...e){super(...e),(0,i.Z)(this,"markerEl",void 0)}};C=k([(0,a.Ei)({map:null,marker:null,props:{isPlay:Boolean,chosenSpeed:Number},computed:{...(0,x.rn)({coordinates:e=>e.coordinates,position:e=>e.position,isLoading:e=>e.isLoading,stepCounter:e=>e.stepCounter}),...(0,x.Se)({maxSteps:"maxSteps"})},methods:{move(){this.isPlay&&this.$store.commit("nextStep")}},mounted(){this.myMap=new P("map__box"),this.myMap.onLoad((()=>{this.myMap.createLine("trace","#888",.4,8),this.myMap.createLine("plume","#093",1,6),this.$store.dispatch("getCoordinates"),this.myMap.resize()}))},watch:{isLoading(e){e||(this.myMap.setCoordinatesToLine("trace",this.coordinates),this.myMap.setCoordinatesToLine("plume",this.coordinates.slice(0,this.stepCounter)),this.myMap.setCoordinateToMarker(this.position))},isPlay(e){e&&this.move()},stepCounter(){this.stepCounter>0&&this.myMap.moveToPointWithPlume("plume",this.coordinates.slice(0,this.stepCounter),this.position,10*this.chosenSpeed,(()=>this.move()))}}})],C);var L=C,M=s(89);const j=(0,M.Z)(L,[["render",f],["__scopeId","data-v-24e1cd46"]]);var S=j,O=s(7139);const I={key:0,class:"map__progress"},T=(0,o._)("div",{class:"indicator"},null,-1);function R(e,t,s,r,i,a){return(0,o.wg)(),(0,o.j4)(n.uT,{name:"progress"},{default:(0,o.w5)((()=>[e.isLoading?((0,o.wg)(),(0,o.iD)("div",I,[T,(0,o._)("div",null,(0,O.zw)(e.parceProgress)+"%",1)])):(0,o.kq)("",!0)])),_:1})}var D=function(e,t,s,n){var o,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,s,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,s,i):o(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};let Z=class extends a.w3{constructor(...e){super(...e),(0,i.Z)(this,"colorIndicator",void 0)}};Z=D([(0,a.Ei)({computed:{...(0,x.rn)({isLoading:e=>e.isLoading,parceProgress:e=>e.parceProgress})}})],Z);var W=Z;const E=(0,M.Z)(W,[["render",R]]);var N=E,F=s.p+"img/play-solid.e01c3703.svg",q=s.p+"img/pause-solid.02c1d07d.svg",z=s.p+"img/backward-solid.def5b2ca.svg",B=s.p+"img/forward-solid.5a3efb62.svg";const $=e=>((0,o.dD)("data-v-293aa168"),e=e(),(0,o.Cn)(),e),A={key:0,class:"map__controller"},G={class:"switch_btns"},J=$((()=>(0,o._)("img",{src:F,alt:""},null,-1))),Y=$((()=>(0,o._)("img",{src:q,alt:""},null,-1))),H={class:"select__box"},K=$((()=>(0,o._)("img",{src:z,alt:""},null,-1))),Q={class:"select__cards"},U={class:"card__content"},V=$((()=>(0,o._)("img",{src:B,alt:""},null,-1)));function X(e,t,s,r,i,a){const c=(0,o.up)("book-mark-card");return(0,o.wg)(),(0,o.j4)(n.uT,{name:"controller"},{default:(0,o.w5)((()=>[e.isLoading||e.isFirstLoading?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",A,[(0,o._)("div",G,[(0,o.Wm)(c,{class:(0,O.C_)(["switch__btn",{switch__btn_active:e.isPlay}]),onClick:t[0]||(t[0]=t=>e.$emit("startPlay"))},{default:(0,o.w5)((()=>[J])),_:1},8,["class"]),(0,o.Wm)(c,{class:(0,O.C_)(["switch__btn",{switch__btn_active:!e.isPlay}]),onClick:t[1]||(t[1]=t=>e.$emit("stopPlay"))},{default:(0,o.w5)((()=>[Y])),_:1},8,["class"])]),(0,o._)("div",H,[(0,o.Wm)(c,{class:(0,O.C_)(["select__btn",{hiden__select__btn:e.speedIndex<=0}]),onClick:e.lastSpeed},{default:(0,o.w5)((()=>[K])),_:1},8,["onClick","class"]),(0,o._)("div",Q,[(0,o.Wm)(c,{style:{visibility:"hidden"}}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.speeds,(t=>((0,o.wg)(),(0,o.j4)(c,{key:t,class:(0,O.C_)(["select__card",{chosen__select__card:t===e.speeds[e.speedIndex]}])},{default:(0,o.w5)((()=>[(0,o._)("div",U,(0,O.zw)(t),1)])),_:2},1032,["class"])))),128))]),(0,o.Wm)(c,{class:(0,O.C_)(["select__btn",{hiden__select__btn:e.speedIndex>=e.speeds.length-1}]),onClick:e.nextSpeed},{default:(0,o.w5)((()=>[V])),_:1},8,["onClick","class"])])]))])),_:1})}const ee={class:"bookmark"},te={class:"box__content"};function se(e,t,s,n,r,i){return(0,o.wg)(),(0,o.iD)("div",ee,[(0,o._)("div",te,[(0,o.WI)(e.$slots,"default",{class:"content"})])])}var ne=function(e,t,s,n){var o,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,s,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,s,i):o(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};let oe=class extends a.w3{};oe=ne([(0,a.Ei)({})],oe);var re=oe;const ie=(0,M.Z)(re,[["render",se]]);var ae=ie,ce=function(e,t,s,n){var o,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,s,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,s,i):o(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};let le=class extends a.w3{};le=ce([(0,a.Ei)({props:{isPlay:Boolean,speeds:Array,speedIndex:Number},data(){return{isFirstLoading:!0}},components:{BookMarkCard:ae},methods:{nextSpeed(){if(this.speedIndex<this.speeds.length-1){const e=this.speedIndex+1;this.$emit("setSpeedIndex",e)}},lastSpeed(){if(this.speedIndex>0){const e=this.speedIndex-1;this.$emit("setSpeedIndex",e)}}},computed:{...(0,x.rn)({isLoading:e=>e.isLoading})},watch:{isLoading(e){e||(this.isFirstLoading=!1)}}})],le);var de=le;const pe=(0,M.Z)(de,[["render",X],["__scopeId","data-v-293aa168"]]);var ue=pe,he=function(e,t,s,n){var o,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,s,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,s,i):o(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};let fe=class extends a.w3{constructor(...e){super(...e),(0,i.Z)(this,"isPlay",void 0)}};fe=he([(0,a.Ei)({components:{Map:S,MapProgress:N,MapController:ue},data(){return{isPlay:!1,speedIndex:0,speeds:[30,50,70,90]}},computed:{...(0,x.rn)({isLoading:e=>e.isLoading}),chosenSpeed(){return this.speeds[this.speedIndex]}}})],fe);var me=fe;const ge=(0,M.Z)(me,[["render",l],["__scopeId","data-v-11951897"]]);var ve=ge,ye=function(e,t,s,n){var o,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,s):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,s,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(r<3?o(i):r>3?o(t,s,i):o(t,s))||i);return r>3&&i&&Object.defineProperty(t,s,i),i};let _e=class extends a.w3{constructor(...e){super(...e),(0,i.Z)(this,"msg",void 0)}};_e=ye([(0,a.Ei)({data(){return{msg:""}},components:{MapBox:ve}})],_e);var be=_e;const we=(0,M.Z)(be,[["render",r]]);var Pe=we,xe=s(6265),ke=s.n(xe),Ce=new x.ZP.Store({state:{coordinates:[],stepCounter:0,position:[0,0],isLoading:!1,parceProgress:0},getters:{maxSteps(e){return e.coordinates.length}},mutations:{nextStep(e){e.stepCounter<=e.coordinates.length&&(e.position=e.coordinates[e.stepCounter],e.stepCounter++)},setLoading(e,t){e.isLoading=t},setParseProgress(e,t){e.parceProgress=t},setCoordinates(e,t){e.coordinates=t,e.position=t[0]}},actions:{async getCoordinates({commit:e}){try{e("setLoading",!0);const t=await ke().get("https://bibix.gitlab.io/cdu-test/coordinates.ts",{headers:{"Content-Type":"text/plain"}}),s=[...t.data.matchAll(/".{19}",\s*([1-8]?\d(\.\d+)?|90(\.0+)?),\s*(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)/g)],n=await this.dispatch("parseStrToCordinate",s);e("setCoordinates",n),e("setLoading",!1)}catch(t){console.error(t)}},parseStrToCordinate({commit:e},t){const s=100,n=[];return new Promise((o=>{let r=[],i=0;const a=()=>setTimeout((()=>{let c=0,l=null;while(c<s){if(i+c>=t.length)break;const e=t[i+c][0].split(", "),s={date:new Date(e[0].substring(1,20)),lon:Number(e[1]),lat:Number(e[2])};v(l,s)||null===l||r.push([l.lon,l.lat]),l=s,c++}i+=c,i<t.length?(r.forEach((e=>n.push(e))),e("setParseProgress",Math.floor((i+1)/t.length*100)),r=[],a()):(n.push([l.lon,l.lat]),e("setParseProgress",100),o(n))}),0);a()}))}},modules:{}});const Le=(0,n.ri)(Pe);Le.use(Ce).mount("#app")}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,s),r.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,r){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],r=e[d][2];for(var a=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(s.O).every((function(e){return s.O[e](n[c])}))?n.splice(c--,1):(a=!1,r<i&&(i=r));if(a){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,o,r]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.p=""}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,i=n[0],a=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(c)var d=c(s)}for(t&&t(n);l<i.length;l++)r=i[l],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},n=self["webpackChunktest_quest_cdu"]=self["webpackChunktest_quest_cdu"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[998],(function(){return s(3399)}));n=s.O(n)})();
//# sourceMappingURL=app.4c02cf5d.js.map